<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Twitter Clone</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<link rel="stylesheet" href="{{url_for('static', filename='css/index.css')}}">
</head>

<body>
	<header
		class="d-flex flex-wrap align-items-center justify-content-center justify-content-md-between py-3 mb-4 border-bottom">

		<ul class="nav col-12 col-md-auto mb-2 justify-content-center mb-md-0">
			<li><a href="/" class="nav-link px-2 {%if request.path == '/'%}link-secondary{%endif%}">Home</a></li>
			<li><a href="/about" class="nav-link px-2 {%if request.path == '/about'%}link-secondary{%endif%}">About</a></li>
		</ul>

		<div class="col-md-3 text-end">
			{%if current_user.is_authenticated%}
			<p class="text-center mb-0">
				<span>Hello {{current_user.username}}</span>
				<img id="user_pfp">
				<button onclick='window.location.href="auth/logout"' type="button" class="btn btn-outline-primary mb-1">Logout</button>
			</p>
			{%else%}
			<button onclick='window.location.href = "auth/login"' type="button" class="btn btn-outline-primary me-2">Login</button>
			<button onclick='window.location.href = "auth/signup"' type="button" class="btn btn-primary">Sign Up</button>
			{%endif%}
		</div>
	</header>

	{% block content %}
	{% endblock %}

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.7/dist/umd/popper.min.js"
		integrity="sha384-zYPOMqeu1DAVkHiLqWBUTcbYfZ8osu1Nd6Z89ify25QV9guujx43ITvfi12/QExE"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js"
		integrity="sha384-Y4oOpwW3duJdCWv5ly8SCFYWqFDsfob/3GkgExXKV4idmbt98QcxXYs9UoXAB7BZ"
		crossorigin="anonymous"></script>

	{% block script %}
	{% endblock %}
	<script>
		// Function for getting a profile picture
		function set_pfp(user_id, element){
			const data = {"user_id": user_id};
	
			fetch(window.location.origin + "/api/pfp", {
				method: "POST",
				body: JSON.stringify(data),
				headers: {"Content-type": "application/json; charset=UTF-8"}
			})
			.then(response => response.blob())
			.then(response => {
				element.src = URL.createObjectURL(response);
			});
		}
	</script>
	<script>
		{% if current_user.is_authenticated %}
			set_pfp({{current_user.id}} ,document.getElementById("user_pfp"))
		{% endif %}
	</script>
</body>

</html>